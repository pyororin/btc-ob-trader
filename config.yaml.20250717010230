# OBI-Scalp-Bot 設定ファイル (config.yaml)

# --- 戦略パラメータ ---
# これらの値は、ボットの売買戦略に直接影響します。

# 取引ペア
pair: "btc_jpy"
# 許容する最大スプレッド（円）
spread_limit: 60
# 1注文あたりの最大ロット比率（対利用可能残高）
lot_max_ratio: 0.05
# 注文比率
order_ratio: 0.2

# ロングエントリー戦略
long:
  # OBIの閾値
  obi_threshold: 0.35
  # 利食い幅（円）
  tp: 30
  # 損切り幅（円）
  sl: -20

# ショートエントリー戦略
short:
  # OBIの閾値
  obi_threshold: -0.35
  # 利食い幅（円）
  tp: 30
  # 損切り幅（円）
  sl: -20

# ボラティリティ設定
volatility:
  # EWMA（指数平滑移動平均）のλ値
  ewma_lambda: 0.3
  # 動的OBI設定
  dynamic_obi:
    # 有効化フラグ
    enabled: false
    # ボラティリティ係数
    volatility_factor: 1.6
    # 最小閾値係数
    min_threshold_factor: 0.8
    # 最大閾値係数
    max_threshold_factor: 1.6

# TWAP（時間加重平均価格）注文設定
twap:
  # 有効化フラグ
  enabled: false
  # 1注文あたりの最大サイズ（BTC）（下限0.01）
  max_order_size_btc: 0.01
  # 注文間隔（秒）
  interval_seconds: 5

# シグナル設定
signal:
  # シグナル確定までの待機時間（ミリ秒）
  # OBIが閾値を超えても即座にエントリーせず、この時間だけ閾値を超え続けた場合にシグナルが確定します。
  # 値を大きくするとダマシを避けやすくなりますが、エントリーは遅れます。
  # 値を小さくすると素早く反応できますが、ノイズに弱くなります。
  hold_duration_ms: 400


# --- アプリケーション設定 ---
# ボットの動作、データベース接続、リプレイモードなど、システム全体に関わる設定です。

# ログレベル ("debug", "info", "warn", "error")
log_level: "info"

# 注文執行エンジン設定
order:
  # 注文タイムアウト時間（秒）
  # 指値注文がこの時間内に約定しない場合、自動的にキャンセルされます。
  # 値を大きくすると約定の機会は増えますが、相場変動リスクも高まります。
  # 値を小さくすると機会損失は減りますが、約定チャンスを逃す可能性もあります。
  timeout_seconds: 20
  # 注文状況確認のポーリング間隔（ミリ秒）
  # 注文の約定状況を取引所に確認しにいく頻度です。
  # 売買戦略には直接影響しませんが、APIリクエスト頻度に関わるため、短くしすぎないでください。
  poll_interval_ms: 2000

# データベース接続設定
database:
  host: "timescaledb"
  port: 5432
  user: ""
  password: ""
  name: "obi_scalp_bot_db"
  sslmode: "disable"

# データベース書き込み設定
db_writer:
  # 一度に書き込むバッチサイズ
  batch_size: 100
  # 書き込み間隔（秒）
  write_interval_seconds: 5
  # 非同期書き込みの有効化
  enable_async: false

# リプレイモード設定
replay:
  # 開始時刻 (RFC3339形式)
  start_time: "2025-07-13T00:00:00Z"
  # 終了時刻 (RFC3339形式)
  end_time: "2025-07-14T00:00:00Z"

# PnLレポート設定
pnl_report:
  # レポート生成間隔（分）
  interval_minutes: 1
  # レポートの最大保存期間（時間）
  max_age_hours: 24
